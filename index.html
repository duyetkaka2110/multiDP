<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Player Live</title>
    <meta name="theme-color" content="#000000" />
    <meta http-equiv="Permissions-Policy" content="fullscreen=*">

    <!-- 1. Tải các thư viện Player -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script
        src="https://sf-unpkg.bytepluscdn.com/obj/byteplusfe-sg/sdk/@byteplus/veplayer/2.9.1/umd/veplayer.production.js"></script>
    <script src="https://player.bakent.live/2.0/js/hls/hls.js"></script>
    <script src="https://player.bakent.live/2.0/js/bakmedia.js"></script>
    <!-- THÊM MỚI: Thư viện cho ZLMediaKit WebRTC -->

    <!-- 2. Tải các file CSS -->
    <link rel="stylesheet"
        href="https://sf-unpkg.bytepluscdn.com/obj/byteplusfe-sg/sdk/@byteplus/veplayer/2.9.1/umd/veplayer.production.css">
    <link rel="apple-touch-icon" sizes="180x180" href="https://cdn.bakent.live/bakent/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://cdn.bakent.live/bakent/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://cdn.bakent.live/bakent/favicon-16x16.png">
    <link rel="manifest" href="https://cdn.bakent.live/bakent/site.webmanifest">
    <!-- Tải file CSS của bạn -->
    <link id="app-css" rel="stylesheet">
    <script>
        const css = document.getElementById("app-css");
        css.href = "https://player.bakent.live/2.0/css/app.css?v=1.3&ts=" + new Date().getTime();
    </script>
</head>

<body>

    <style>
        body {
            position: relative;
            width: 100vw;
            height: 100vh;
            margin: 0 0 0 0;
            transform: translateZ(0);
            -webkit-user-select: none;
            -webkit-touch-callout: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            -o-user-select: none;
            user-select: none;
            background-color: black;
            overflow: hidden;
        }

        .mg-button {
            position: absolute;
            top: 25px;
            right: 0px;
            display: none;
            justify-content: center;
            max-width: 700px;
            z-index: 1000;
        }

        .btn-menu {
            position: absolute;
            top: 0px;
            right: 0px;
            padding: 3px 5px;
            background: #ba12cd;
            color: #fff;
            z-index: 1000;
        }

        .mg-button button {
            width: 7em;
            display: block;
            border: none;
            font-weight: bold;
            margin: 3px;
            padding: 10px 5px;
            z-index: 1000;
        }

        .video {
            position: relative;
            z-index: 1;
        }

        @media screen and (max-width: 500px) {

            .btn-menu,
            .mg-button button {
                font-size: 11px;
            }
        }

        .mg-button button.active {
            background-color: aquamarine;
        }

        .video-container {
            overflow: hidden;
            position: relative;
            padding-bottom: 56.25%;
            /* 16:9 Aspect Ratio (9 / 16 = 0.5625) */
            height: 0;
            overflow: hidden;
            max-width: 100%;
            /* Ensures it doesn't exceed parent width */
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* Custom scrollbar for WebKit browsers */
        ::-webkit-scrollbar {
            width: 1px;
            /* Set the width of the vertical scrollbar */
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            /* Color of the scrollbar track */
        }

        ::-webkit-scrollbar-thumb {
            background: #888;
            /* Color of the scrollbar thumb */
            border-radius: px;
            /* Rounded corners for the thumb */
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #555;
            /* Color of the thumb on hover */
        }
    </style>
    <div id="ve-player-wrapper" class="player-container">
        <div id="veplayer"></div>
    </div>

    <div id="hls-player-wrapper" class="player-container">
        <video id="hls-player" autoplay muted controls playsinline></video>
        <div class="player-overlay" id="hls-overlay">
            <div class="loader"></div>
            <p class="status-text"></p>
            <button class="unmute-button">Bấm để bật tiếng 🔊</button>
        </div>
    </div>

    <div id="webrtc-player-wrapper" class="player-container">
        <video id="webrtc-player" autoplay muted controls playsinline></video>
        <div class="player-overlay" id="webrtc-overlay">
            <div class="loader"></div>
            <p class="status-text"></p>
            <button class="unmute-button">Bấm để bật tiếng 🔊</button>
        </div>
    </div>
    <div class="btn-menu" href="#" onclick="myFunction()"><i class="fa fa-bars"></i> Server</div>
    <div class="mg-button" id="myLinks">
        <button class="b0 active" data-id="0" onclick="myFunction()">SERVER 1</button>
        <button class="b1" data-id="1" onclick="myFunction()">SERVER 2</button>
        <button class="b2" data-id="2" onclick="myFunction()">SERVER 3</button>

    </div>
    <!-- <link rel="stylesheet" href="index.min.css">
    <script src="index.min.js"></script> -->
    <!-- <div class="video video-container"> -->
    <!-- </div> -->


    <!-- <script type="module" src="https://player.bakent.live/js/app.js?v=<?= Date.now() ?>"></script> -->
    <script>
        const script = document.createElement('script');
        script.type = 'module';
        script.src = `https://player.bakent.live/2.0/js/app.bundle.js?t=${Date.now()}`;
        document.head.appendChild(script);
    </script>
    <script>
        // Đọc param hiện tại và set active theo index
        (function initButtons() {
            const params = new URLSearchParams(window.location.search);
            const currentIndex = Number(params.get('index')) || 0;
            if (currentIndex > 2) {
                currentIndex = 0;
            }

            // Set active cho nút tương ứng
            document.querySelectorAll('.mg-button button').forEach(btn => btn.classList.remove('active'));
            const activeBtn = document.querySelector(`.mg-button .b${currentIndex}`);
            if (activeBtn) activeBtn.classList.add('active');
        })();

        function myFunction() {
            var x = document.getElementById("myLinks");
            if (x.style.display === "block") {
                x.style.display = "none";
            } else {
                x.style.display = "block";
            }
        }

        // Click nút -> reload trang với ?index= tương ứng (giữ các query khác nếu có)
        $(document).on("click", ".mg-button button", function () {
            const id = $(this).data("id");
            const params = new URLSearchParams(window.location.search);
            params.set('index', id);
            window.location.search = params.toString();
        });
    </script>
</body>

</html>